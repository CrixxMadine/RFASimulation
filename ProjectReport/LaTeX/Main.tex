%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Template f체r die Erstellung einer Arbeit an der TH N체rnberg
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Definition des Grunds채tzlichen dokumententyps und -layouts
\documentclass[parskip=half, titlepage=yes, 12pt, BCOR=12mm, DIV=calc]{scrartcl}

% Definition der Praeambel
% Praeambel = Quasi-Klasse mit Definitionen des Layouts
% und Definition einbinden der verwendeten Pakete
\input{Praeambel}


\usepackage{amsthm}
\usepackage{lipsum}

%% Hier startet der eigentliche Dokumenteninhalt
\begin{document}


%% Titelblatt und Verzeichnisse
\maketitle
\tableofcontents

\clearpage

\listoffigures
\listoftables
\lstlistoflistings
\clearpage


% part 1, Introduction 

\section{Introduction}

Lets talk about:\\
- Medical Treatment of Tumor\\
- Radio frequency ablation\\
- Why RFA Simulation is important \\
- Motivation \\
- This project in General\\

% part 2, Main

\section{Computer-aided simulation of radio frequency ablation with finite elements}

\subsection{About Errors in simulations and numerical approaches}
- see TUM dissertation \\
- There are different sources for errors following the simulation from the line from the real problem down to the discrete solution \\
- Idealization error: discrepancy between reality and the idealized reality and the idealized constitutive laws and boundary conditions -> Systems are often way more complex in reality, every patient is different \\
- Modeling errors: discrepancy between mathematical formulation and physical model -> e.g. using dimensionally reduced approaches, like linear dependencies or even constant parameters  \\
-  Discretization errors: discrepancy between the continous description and discrete discription of the model \\
- Solution errors: using iterative approximation methods and rounding errors \\
- It's basically a butterfly effect \\
- Optimizing one error source often conflicts with another one -> e.g. handling nonlinearity can cause fatal numerical errors (at least that's what Kroeger said ...)

\subsection{Theory of finite elements}

\subsubsection{Elliptical problems}
- Elliptical problems in general \\
- build up system of PDE's to describe problem \\
- Using the cylindric domain, different domains \\

\subsubsection{FEM for electrical fields}
- special domain \\
- boundary conditions \\

\subsubsection{FEM for temperature fields}
- boundary condition (heat source or sink) \\

\subsubsection{Axial symmetrie}
- Using axial symmetrie to simplify computations \\
- reducing one dimension 3D -> 2D \\
- significant savings calculations time and complexity \\
- approach: fourier decomposition in angular direction to reduce dependency on the angular $\varphi$ \\
- using static models, only dependency on space \\
- maybe Torus elements \\


\subsection{This part is about the concrete PDEs itself}

\subsubsection{FEM in cylindric Coordinates}
- Rewrite the equations to cylindric coordinates \\
 
Laplace in cartesian coordinates:
\begin{equation}
    \nabla^2 := \Delta := \frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2} + \frac{\partial^2}{\partial z^2}
\end{equation}

Laplace in cylindric coordinates:
\begin{equation}
    \Delta := \frac{\partial^2}{\partial r^2} + \frac{1}{r} \frac{\partial}{\partial r} + \frac{1}{r^2} \frac{\partial^2}{\partial \phi^2} + \frac{\partial^2}{\partial z^2}
\end{equation}

Laplace in polar coordinates:
\begin{equation}
    \Delta := \frac{\partial^2}{\partial r^2} + \frac{1}{r} \frac{\partial}{\partial r} + \frac{1}{r^2} \frac{\partial^2}{\partial \phi^2}
\end{equation}



\subsubsection{PDE for Electric potential}

Three parts are interesting:
- Inner domain \\
- Fixed Potential of electrodes \\
- Inner domain \\
- Outer boundary -> Robin \\

Constant material parameters: \\

\subsubsection{Inner Domain}

- The electric potential of the inner domain is described as : 

\begin{equation}
    - \nabla \cdot (\sigma(x,y,z,t) \nabla \varphi(x,y,z,t)) = 0
\end{equation}

- Elliptical boundary problem \\
- Assuming constant material parameters: $\nabla \sigma = 0$ \\
- Solution is independent from $\sigma$ so we can cut it out
- Equation becomes Laplaces' equation, phi becomes time independent \\

\begin{equation}
    - \Delta \varphi(x,y,z) = 0
\end{equation}

- Using a cylindric domain, we can use cylinder coordinates (see ref Laplace in cylinder)

\begin{equation}
    - \Delta \varphi(r,\phi,z) = - \frac{1}{r} \frac{\partial \varphi}{\partial r} - \frac{\partial^2 \varphi}{\partial r^2} - \frac{1}{r^2} \frac{\partial^2 \varphi}{\partial \phi^2} -      \frac{\partial^2 \varphi}{\partial z^2}  = 0
\end{equation}

- Since the domain has axis symmetry, the solution for $\varphi$ is independant from the angular $\phi$ \\
- So equation simplifies to

\begin{equation}
    - \frac{1}{r} \frac{\partial \varphi}{\partial r} - \frac{\partial^2 \varphi}{\partial r^2} - \frac{\partial^2 \varphi}{\partial z^2} = 0
\end{equation}

- PDE is now parabolic and no longer elliptic \\
- We will care about a more complex formulation later 


\subsubsection{Electrodes}

- $\phi$ = $\pm$ 1

\subsubsection{Outer boundary}

- For first try, a simplification with natural boundary conditions

\begin{equation}
    n \cdot \nabla \varphi = 0
\end{equation}

- In cylindrical coordinates
\begin{equation}
    TODO
\end{equation}

\subsubsection{PDE for temperature Distribution}

Following Kroeger, the temperature distribution is modeled by the heat equation: 

\begin{equation}
    \partial_t (\rho c T) - \nabla \cdot (\lambda \nabla T) = Q
\end{equation}

The heat equation is a well known parabolic partial differential equation. \\

We are assuming $\rho$ and $c$ are constant \\
$\rho$ = density \\
$c$ = specific heat capacity \\
$\lambda$ = thermal conductivity, which is depending on T \\
T = T(r,z,t) = temperature \\
Q = Q(r,z,t) = heat energy \\


Cylindrical coordinates: see 'Transient Heat Transfer in a Partially Cooled Cylindrical Rod' from Lawrence Agbezuge

\begin{equation}
    \rho c \frac{\partial T}{\partial t} -  \frac{d\lambda}{dT} \left[ \left( \frac{\partial T}{\partial r} \right)^2 + \left( \frac{\partial T}{\partial z} \right)^2 \right] - \lambda \left( \frac{\partial^2 T}{\partial r^2} + \frac{1}{r} \frac{\partial T}{\partial r} + \frac{\partial^2 T}{\partial z^2} \right) = Q
\end{equation}

For the first run, we assume $lambda$ is also constant too, which greatly reduces the complexity of the problem to the form

\begin{equation}
    \rho c \frac{\partial T}{\partial t} - \lambda \left( \frac{\partial^2 T}{\partial r^2} + \frac{1}{r} \frac{\partial T}{\partial r} + \frac{\partial^2 T}{\partial z^2} \right) = Q
\end{equation}

\textcolor{red}{TODO: explain Q her}

$Q = Q_(rf) + Q_{perf}$

\section{Applied FEM-Simulation}
\subsection{Weak solutions}

Electric potential / Laplace's equation in cylindrical domain:

\begin{equation}
    a_w(u,v) := \int_{\Omega} (\partial_r u \partial_r v + \partial_z u \partial_z v) r drdz = \int_{\Omega} f v r dr dz
\end{equation}

- $u \in H_r^1(\Omega) \cap \{v|_{\Gamma_{0}} = 0 \} $ \\
- $v \in H_r^1(\Omega) \cap \{v|_{\Gamma_{0}} = 0 \} $ \\

Approximate with linear regression functions\\
Linear regression functions for reference triangles:
\begin{align}
    \phi_1(\xi, \eta) &= 1 - \xi - \eta \\
    \phi_2(\xi, \eta) &= \xi \\
    \phi_2(\xi, \eta) &= \eta 
\end{align}

Specific PDE for electric potential, inner domain: 

\begin{equation}
    a_w(u,v) := \int_{\Omega} (\partial_r u \partial_r v + \partial_z u \partial_z v) r drdz = 0 
\end{equation}


\subsection{Grid generation / Triangulation}

\subsection{Get TestData}

\subsection{Solving the PDEs}
\subsubsection{numerical challenges}
\subsubsection{numerical integration}
\subsubsection{solving the system of equations}

\subsection{Interpretation of result numbers}

\subsection{Graphical output}

\subsection{Optimization}

\subsection{MatLab vs C++}

- Basically the performance advantages of using C++

% part 3, Summary

\section{Summary and Outlook}

\subsection{Project Summary}

\textcolor{blue}
{
This is the conclusion part
}

\subsection{strengths and flaws}
- why is it good, why is it bad

\subsection{State of the current Research}
- Research in the simulation of medical therapy methods \\

\subsection{Other FEM projects and software}


\newpage


%% Literaturverzeichnis mit allen Eintr채gen der .bib-Datei
\clearpage
\nocite{*}
\printbibliography

\newpage

%% Letzter Teil, Anhang
\appendix

\input{Appendix} 

\end{document} 